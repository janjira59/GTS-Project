<!DOCTYPE html>
<html lang="en">

<head>
    <script>
        var local = localStorage.getItem("session");
          if (local === "undefined" || local === null) {
           
            window.location.href = "../index.html";
          }
    </script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Creative - Bootstrap 3 Responsive Admin Template">
  <meta name="author" content="GeeksLabs">
  <meta name="keyword" content="Creative, Dashboard, Admin, Template, Theme, Bootstrap, Responsive, Retina, Minimal">
  <link rel="shortcut icon" href="img/favicon.png">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

  <title>GTS Project</title>

  <!-- Bootstrap CSS -->
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <!-- bootstrap theme -->
  <link href="css/bootstrap-theme.css" rel="stylesheet">
  <!--external css-->
  <!-- font icon -->
  <link href="css/elegant-icons-style.css" rel="stylesheet" />
  <link href="css/font-awesome.min.css" rel="stylesheet" />
  <!-- full calendar css-->
  <link href="assets/fullcalendar/fullcalendar/bootstrap-fullcalendar.css" rel="stylesheet" />
  <link href="assets/fullcalendar/fullcalendar/fullcalendar.css" rel="stylesheet" />
  <!-- easy pie chart-->
  <link href="assets/jquery-easy-pie-chart/jquery.easy-pie-chart.css" rel="stylesheet" type="text/css" media="screen" />
  <!-- owl carousel -->
  <link rel="stylesheet" href="css/owl.carousel.css" type="text/css">
  <link href="css/jquery-jvectormap-1.2.2.css" rel="stylesheet">
  <!-- Custom styles -->
  <link rel="stylesheet" href="css/fullcalendar.css">
  <link href="css/widgets.css" rel="stylesheet">
  <link href="css/style.css" rel="stylesheet">
  <link href="css/style-responsive.css" rel="stylesheet" />
  <link href="css/xcharts.min.css" rel=" stylesheet">
  <link href="css/jquery-ui-1.10.4.min.css" rel="stylesheet">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>

<body>
  <!-- container section start -->
  <section id="container" class="">

    <header class="header dark-bg">
      <div class="toggle-nav">
        <div class="icon-reorder tooltips" data-original-title="Toggle Navigation" data-placement="bottom"><i class="icon_menu"></i></div>
      </div>

      <!--logo start-->
      <a href="editor.html" class="logo">GTS<span class="lite">KMUTNB</span></a>
      <!--logo end-->

      <div class="top-nav notification-row">
        <!-- notificatoin dropdown start-->
        <ul class="nav pull-right top-menu">
          <a class="" href="index.html">
            คุณ <div id="result"></div>
          <span class="" onclick="logout()">Logout</span>
        </a>
        </ul>
        <!-- notificatoin dropdown end-->
      </div>
    </header>
    <!--header end-->
      <!--sidebar start-->
      <aside>
        <div id="sidebar" class="nav-collapse ">
          <!-- sidebar menu start-->
          <ul class="sidebar-menu">
            <li class="active">
              <a class="" href="editor.html">
                <i class="icon_table"></i>
                <span>แสดงผลการทำงาน</span>
              </a>
            </li>
            <li class="active">
              <a class="" href="addguardeditor.html">
                <i class="icon_document_alt"></i>
                <span>เพิ่มข้อมูลเจ้าหน้าที่รักษาความปลอดภัย</span>
              </a>
            </li>
            <li class="active">
              <a class="" href="guardeditor.html">
                <i class="icon_pencil-edit_alt"></i>
                <span>ดูข้อมูลเจ้าหน้าที่รักษาความปลอดภัย</span>
              </a>
            </li>
            <li class="active">
              <a class="" href="usereditor.html">
                <i class="icon_pencil-edit_alt"></i>
                <span>ดูข้อมูลผู้ใช้งาน</span>
              </a>
            </li>
            <li class="active">
              <a class="" href="grapheditor.html">
                <i class="icon_piechart"></i>
                <span>กราฟแสดงผล</span>
              </a>
            </li>
          </ul>
        </div>
      </aside>
      <!-- sidebar menu end-->
    <!--main content start-->
    <section id="main-content">
      <section class="wrapper">
        <!--overview start-->
        <div class="row">
          <div class="col-lg-12">
            <h3 class="page-header"><i class="icon_document_alt"></i>ดูข้อมูลเจ้าหน้าที่รักษาความปลอดภัย</h3>
            <ol class="breadcrumb">
              <li><i class="icon_table"></i>ดูข้อมูลเจ้าหน้าที่รักษาความปลอดภัย Guard</li>
            </ol>
          </div>
        </div>

        <div class="row">
          <div class="col-lg-12">
            <section class="panel">
              <header class="panel-heading">
                ข้อมูลของเจ้าหน้าที่รักษาความปลอดภัย (Guard)
              </header>
              <table class="table table-striped table-advance table-hover" id="ex-table">
                <tbody>
                  <tr>
                    <th>รหัสประจำตัว</th>
                    <th>ชื่อ - นามสกุล</th>
                    <th>เบอร์โทรศัพท์</th>
                    <th>รหัสบัตรประชาชน</th>
                    <th>TAG ID</th>
                    <th>รูปภาพ</th>
                    <th> Action</th>
                  </tr>
                </tbody>
              </table>
            </section>
          </div>
        </div>

        <script src="https://www.gstatic.com/firebasejs/live/3.0/firebase.js"></script>
        <script>
        var txt_title,txt_content,txt_img ='';
        var config = {
          apiKey: "AIzaSyAzQt8zTPXaL2RT48Z_oLDucPCndXXxmDw",
          authDomain: "gtslogic.firebaseapp.com",
          databaseURL: "https://gtslogic.firebaseio.com",
          projectId: "gtslogic",
          storageBucket: "gtslogic.appspot.com",
          messagingSenderId: "754828374672"
          };
          firebase.initializeApp(config);
          var database = firebase.database();
          database.ref("guards/").once('child_added', function(snapshot){ //ดึงnode users
          if(snapshot.exists()){
            var content = '';
            snapshot.forEach(function(data){
              var val = data.val();
              console.log("row",data.val());
              console.log("title",data.getKey());
              content +='<tr>';
              // content += '<td>' + data.getKey() + '</td>';
              content += '<td>' + val.gid + '</td>';
              content += '<td>' + val.name + ' ' + val.lastname  + '</td>';
              content += '<td>' + val.tel + '</td>';
              content += '<td>' + val.cardid+'</td>';
              content += '<td>' + val.tagid+'</td>';
              content += '<td><a href="'+val.thumbnail+'" target="_blank">ดูรูปภาพ</a></td>';
              content += '<td><a href="editguardeditor.html?id='+data.getKey()+'" class="btn btn-success"><i class="icon_check_alt2"></i>แก้ไข</a></td>';
              content += '<td><a href="deleteguardeditor.html?id='+data.getKey()+'" class="btn btn-danger" onclick="return confirm('+"'ยืนยันการลบ'"+')"";><i class="icon_close_alt2" ></i>ลบ</a></td>';
              content += '</tr>';
              });
              var theDiv = document.getElementById("ex-table");
              theDiv.innerHTML += content;
              }
              });
              var userId = localStorage.getItem("session");
              // alert(userId);
              firebase.database().ref('users/data/' + userId).once('value')
              .then(function(snapshot) {
              $("#result").text(snapshot.val().name);
              });
              function logout() {
                localStorage.removeItem("session");
                window.location.href = "index.html";
              }
              </script>
</body>
</html>
